# Prompty V2 - Phase 4 å®ŒæˆæŠ¥å‘Š

## ğŸ‰ Phase 4 å·²å®Œæˆï¼

**å®Œæˆæ—¶é—´**: 2025-11-01
**å¼€å‘è¿›åº¦**: Phase 4 - UI å’Œäº¤äº’ âœ… 100%

---

## ğŸ“¦ Phase 4 å·²å®ç°çš„åŠŸèƒ½

### 1. ä¸»åº”ç”¨ç•Œé¢ (app.html)
**æ–‡ä»¶**: `app.html` (1600+ è¡Œ)

âœ… **å®Œæ•´çš„ Web åº”ç”¨ç•Œé¢**
- ç°ä»£åŒ–çš„å“åº”å¼è®¾è®¡
- ç¾è§‚çš„é…è‰²æ–¹æ¡ˆå’Œè§†è§‰æ•ˆæœ
- æµç•…çš„åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
- ä¸“ä¸šçš„å¸ƒå±€å’Œæ’ç‰ˆ

---

## ğŸ¨ ç•Œé¢åŠŸèƒ½è¯¦è§£

### 1. Headerï¼ˆé¡¶éƒ¨æ ï¼‰
**åŠŸèƒ½**:
- é¡¹ç›® Logo å’Œç‰ˆæœ¬æ˜¾ç¤º
- è®¾ç½®æŒ‰é’®ï¼ˆé…ç½® API Key å’Œé€‰é¡¹ï¼‰
- å¸®åŠ©æŒ‰é’®ï¼ˆä½¿ç”¨è¯´æ˜ï¼‰
- å†å²è®°å½•æŒ‰é’®ï¼ˆæŸ¥çœ‹ä¿®æ”¹å†å²ï¼‰

**è®¾è®¡ç‰¹è‰²**:
- æ¸å˜èƒŒæ™¯ï¼ˆè“è‰²ç³»ï¼‰
- ç™½è‰²æŒ‰é’®å’Œæ–‡å­—
- ç‰ˆæœ¬å¾½ç« 

---

### 2. Sidebarï¼ˆä¾§è¾¹æ ï¼‰
**åŠŸèƒ½åŒºåŸŸ**:

#### é¡¹ç›®æ–‡ä»¶ä¸Šä¼ åŒº
- ğŸ“ **æ‹–æ‹½ä¸Šä¼ åŒºåŸŸ**
- æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ 
- æ”¯æŒ HTML/CSS/JS æ–‡ä»¶
- ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ 

#### ç‰ˆæœ¬ç®¡ç†åˆ—è¡¨
- ğŸ“¦ **ç‰ˆæœ¬å†å²æ˜¾ç¤º**
- ç‰ˆæœ¬åˆ‡æ¢åŠŸèƒ½
- æ˜¾ç¤ºåˆ›å»ºæ—¶é—´
- é«˜äº®å½“å‰ç‰ˆæœ¬

#### ç»Ÿè®¡ä¿¡æ¯
- ğŸ“Š **å®æ—¶ç»Ÿè®¡**
- æ–‡ä»¶æ•°é‡
- æŸ¥è¯¢æ¬¡æ•°
- ä¿®æ”¹æ¬¡æ•°

**è®¾è®¡ç‰¹è‰²**:
- æ·±è‰²èƒŒæ™¯ï¼ˆ#2c3e50ï¼‰
- åŠé€æ˜ç™½è‰²å…ƒç´ 
- æ‚¬åœæ•ˆæœ
- æ»šåŠ¨æ¡ä¼˜åŒ–

---

### 3. Content Areaï¼ˆä¸»å†…å®¹åŒºï¼‰

#### æŸ¥è¯¢é¢æ¿
**åŠŸèƒ½**:
- ğŸ” **è‡ªç„¶è¯­è¨€è¾“å…¥æ¡†**
  - å¤§å°ºå¯¸è¾“å…¥æ¡†
  - å ä½ç¬¦æç¤º
  - Enter é”®æäº¤
  - è“è‰²èšç„¦æ•ˆæœ

- ğŸ“ **ç¤ºä¾‹æŸ¥è¯¢æ ‡ç­¾**
  - é¢„è®¾å¸¸ç”¨æŸ¥è¯¢
  - ç‚¹å‡»å¿«é€Ÿå¡«å……
  - æ‚¬åœé«˜äº®
  - 4 ä¸ªç¤ºä¾‹ï¼š
    - "æ‰¾åˆ°é¦–é¡µçš„è´­ä¹°æŒ‰é’®"
    - "ä¿®æ”¹å¯¼èˆªæ æ ·å¼"
    - "åˆ é™¤é¡µè„š"
    - "æ‰¹é‡ä¿®æ”¹æŒ‰é’®"

#### ç»“æœå±•ç¤ºé¢æ¿
**åŠŸèƒ½**:
- ğŸ“‹ **æŸ¥è¯¢ç»“æœå¡ç‰‡**
  - æ–‡ä»¶è·¯å¾„æ˜¾ç¤º
  - åŒ¹é…åº¦ç™¾åˆ†æ¯”
  - å…ƒç´ è¯¦ç»†ä¿¡æ¯ï¼ˆæ ‡ç­¾ã€é€‰æ‹©å™¨ã€è¯­ä¹‰ç±»å‹ï¼‰
  - ä»£ç é¢„è§ˆ
  - æ“ä½œæŒ‰é’®ï¼š
    - âœï¸ åˆ›å»ºä¿®æ”¹
    - ğŸ‘ï¸ æŸ¥çœ‹å®Œæ•´ä»£ç 

- ğŸ¯ **ç©ºçŠ¶æ€æ˜¾ç¤º**
  - å‹å¥½çš„ç©ºçŠ¶æ€å›¾æ ‡
  - æ¸…æ™°çš„å¼•å¯¼æ–‡å­—
  - æœªæ‰¾åˆ°ç»“æœæ—¶çš„æç¤º

**è®¾è®¡ç‰¹è‰²**:
- ç™½è‰²å¡ç‰‡
- é˜´å½±æ•ˆæœ
- æ‚¬åœæ”¾å¤§é˜´å½±
- é¢œè‰²ç¼–ç çš„å¾½ç« ï¼ˆæˆåŠŸ=ç»¿è‰²ï¼Œè­¦å‘Š=é»„è‰²ï¼‰
- ä»£ç åŒºåŸŸç­‰å®½å­—ä½“

---

### 4. Preview Modalï¼ˆé¢„è§ˆæ¨¡æ€æ¡†ï¼‰

**åŠŸèƒ½**:
- ğŸ“ **ä¿®æ”¹é¢„è§ˆæ˜¾ç¤º**
  - å…¨å±æ¨¡æ€æ¡†
  - å·®å¼‚å¯¹æ¯”è§†å›¾
  - iframe åµŒå…¥ HTML é¢„è§ˆ
  - æ»šåŠ¨æŸ¥çœ‹å®Œæ•´å†…å®¹

- ğŸ›ï¸ **æ“ä½œæŒ‰é’®**
  - âœ“ åº”ç”¨ä¿®æ”¹ï¼ˆç»¿è‰²ï¼‰
  - å–æ¶ˆï¼ˆç°è‰²ï¼‰

**è®¾è®¡ç‰¹è‰²**:
- åŠé€æ˜é»‘è‰²èƒŒæ™¯é®ç½©
- ç™½è‰²å†…å®¹åŒºåŸŸ
- åœ†è§’å¡ç‰‡
- å¤§å…³é—­æŒ‰é’®ï¼ˆÃ—ï¼‰
- å“åº”å¼å°ºå¯¸ï¼ˆ90% å®½åº¦ï¼Œ90% é«˜åº¦ï¼‰

---

### 5. Settings Modalï¼ˆè®¾ç½®æ¨¡æ€æ¡†ï¼‰

**åŠŸèƒ½**:
- âš™ï¸ **API Key é…ç½®**
  - å¯†ç è¾“å…¥æ¡†ï¼ˆå®‰å…¨ï¼‰
  - æç¤ºæ–‡å­—è¯´æ˜
  - localStorage æŒä¹…åŒ–

- ğŸ¤– **LLM æ¨¡å‹é€‰æ‹©**
  - ä¸‹æ‹‰é€‰æ‹©æ¡†
  - é¢„è®¾ 3 ä¸ªæ¨¡å‹ï¼š
    - Claude 3.5 Sonnetï¼ˆé»˜è®¤ï¼‰
    - GPT-4
    - GPT-3.5 Turbo

- ğŸ”§ **é€‰é¡¹å¼€å…³**
  - è‡ªåŠ¨æ˜¾ç¤ºé¢„è§ˆï¼ˆå¤é€‰æ¡†ï¼‰

**è®¾è®¡ç‰¹è‰²**:
- å°å°ºå¯¸æ¨¡æ€æ¡†ï¼ˆ600pxï¼‰
- è¡¨å•æ ·å¼ç¾åŒ–
- ä¿å­˜å’Œå–æ¶ˆæŒ‰é’®

---

### 6. Status Barï¼ˆçŠ¶æ€æ ï¼‰

**åŠŸèƒ½**:
- ğŸ”´ **çŠ¶æ€æŒ‡ç¤ºå™¨**
  - ç»¿è‰²ç‚¹ï¼šå°±ç»ª
  - é»„è‰²ç‚¹ï¼ˆè„‰å†²ï¼‰ï¼šåŠ è½½ä¸­
  - çº¢è‰²ç‚¹ï¼šé”™è¯¯

- ğŸ“Š **çŠ¶æ€æ–‡å­—**
  - å®æ—¶çŠ¶æ€æ›´æ–°
  - æ“ä½œè¿›åº¦æç¤º

- â„¹ï¸ **ç‰ˆæƒä¿¡æ¯**
  - Powered by ä¿¡æ¯

**è®¾è®¡ç‰¹è‰²**:
- æµ…ç°è‰²èƒŒæ™¯
- å°å­—ä½“
- å›ºå®šåœ¨åº•éƒ¨

---

### 7. Loading Overlayï¼ˆåŠ è½½é®ç½©ï¼‰

**åŠŸèƒ½**:
- â³ **å…¨å±åŠ è½½æç¤º**
  - æ—‹è½¬åŠ¨ç”»
  - "æ­£åœ¨å¤„ç†..." æ–‡å­—
  - é˜»æ­¢ç”¨æˆ·æ“ä½œ

**è®¾è®¡ç‰¹è‰²**:
- åŠé€æ˜ç™½è‰²èƒŒæ™¯
- è“è‰²æ—‹è½¬å™¨
- å±…ä¸­æ˜¾ç¤º

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. åº”ç”¨åˆå§‹åŒ–æµç¨‹
```javascript
async function initializeApp() {
  // 1. åˆå§‹åŒ–æ•°æ®åº“
  app.dbManager = new DatabaseManager();
  await app.dbManager.initialize();

  // 2. åˆå§‹åŒ–è§£æå™¨
  app.parserManager = new TreeSitterParserManager();
  await app.parserManager.initialize();

  // 3. åˆå§‹åŒ–ç‰ˆæœ¬ç®¡ç†å™¨
  app.versionManager = new VersionManager(app.dbManager);

  // 4. åˆå§‹åŒ–ç´¢å¼•æ„å»ºå™¨
  app.indexBuilder = new IndexBuilder(app.dbManager, app.parserManager);

  // 5. åˆå§‹åŒ– NLP å¼•æ“
  app.nlpEngine = new NaturalLanguageQueryEngine(app.dbManager);

  // 6. åˆå§‹åŒ– Tree-sitter æŸ¥è¯¢æ‰§è¡Œå™¨
  app.tsQueryExecutor = new TreeSitterQueryExecutor(...);

  // 7. åˆå§‹åŒ–ä»£ç ä¿®æ”¹å¼•æ“
  app.modEngine = new CodeModificationEngine(...);

  // 8. åˆå§‹åŒ–äº‹åŠ¡ç®¡ç†å™¨
  app.transactionManager = new TransactionManager(...);

  // 9. åˆå§‹åŒ–å·®å¼‚ç”Ÿæˆå™¨
  app.diffGenerator = new DiffGenerator(...);
  app.previewGenerator = new PreviewGenerator(...);

  // 10. åŠ è½½è®¾ç½®
  loadSettings();
}
```

### 2. æ–‡ä»¶ä¸Šä¼ æµç¨‹
```javascript
async function handleFileUpload(event) {
  // 1. åˆ›å»ºæ–°ç‰ˆæœ¬
  const version = await app.versionManager.createVersion(versionName);

  // 2. è¯»å–å¹¶ä¿å­˜æ–‡ä»¶
  for (const file of files) {
    const content = await readFileContent(file);
    // è§£ææ–‡ä»¶
    const parseResult = await app.parserManager.parse(content, language);
    // ä¿å­˜åˆ°æ•°æ®åº“
    await app.dbManager.query(`INSERT INTO files ...`);
  }

  // 3. æ„å»ºç´¢å¼•
  await app.indexBuilder.buildCompleteIndex(version.id);

  // 4. æ›´æ–° UI
  updateStats();
  await loadVersionList();
}
```

### 3. æŸ¥è¯¢æ‰§è¡Œæµç¨‹
```javascript
async function handleQuery() {
  // 1. è·å–æŸ¥è¯¢æ–‡æœ¬
  const query = queryInput.value.trim();

  // 2. æ‰§è¡Œ NLP æŸ¥è¯¢
  const result = await app.nlpEngine.parseAndQuery(query, versionId);

  // 3. æ˜¾ç¤ºç»“æœ
  displayQueryResults(result);

  // 4. æ›´æ–°ç»Ÿè®¡
  app.stats.queries++;
  updateStats();
}
```

### 4. ä¿®æ”¹åˆ›å»ºæµç¨‹
```javascript
async function createModification(resultIndex) {
  // 1. è·å–åŒ¹é…ç»“æœ
  const match = app.currentResults[resultIndex];

  // 2. è¯¢é—®ä¿®æ”¹ç±»å‹
  const modificationType = prompt('é€‰æ‹©ä¿®æ”¹ç±»å‹...');

  // 3. æ ¹æ®ç±»å‹åˆ›å»ºä¿®æ”¹
  let modification = null;
  switch (modificationType) {
    case '1': // setStyle
      modification = new ModificationBuilder()
        .target(match.file_path, match.selector)
        .setStyle(JSON.parse(styleChanges))
        .build();
      break;
    // ... å…¶ä»–ç±»å‹
  }

  // 4. æ·»åŠ ä¿®æ”¹
  app.modEngine.addModification(modification);

  // 5. æ˜¾ç¤ºé¢„è§ˆï¼ˆå¯é€‰ï¼‰
  if (autoPreview) showPreview();
}
```

### 5. é¢„è§ˆç”Ÿæˆæµç¨‹
```javascript
async function showPreview() {
  // 1. ç”Ÿæˆ HTML é¢„è§ˆ
  const previewHTML = await app.previewGenerator.generateHTMLPreview(
    app.currentVersionId,
    app.currentModifications
  );

  // 2. æ˜¾ç¤ºåœ¨ iframe ä¸­
  previewContent.innerHTML = `<iframe srcdoc="${escapeHTML(previewHTML)}"></iframe>`;

  // 3. æ˜¾ç¤ºæ¨¡æ€æ¡†
  document.getElementById('preview-modal').classList.add('active');
}
```

### 6. ä¿®æ”¹åº”ç”¨æµç¨‹
```javascript
async function applyModifications() {
  // 1. ç¡®è®¤æ“ä½œ
  if (!confirm('ç¡®å®šè¦åº”ç”¨ä¿®æ”¹å—ï¼Ÿ')) return;

  // 2. å¼€å§‹äº‹åŠ¡
  const transaction = await app.transactionManager.beginTransaction(description);

  // 3. åº”ç”¨ä¿®æ”¹
  await app.modEngine.applyModifications(versionId);

  // 4. æäº¤äº‹åŠ¡
  await app.transactionManager.commit();

  // 5. æ¸…ç†å’Œæ›´æ–°
  app.modEngine.clearPendingModifications();
  updateStats();
}
```

---

## ğŸ“Š æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **HTML5**: è¯­ä¹‰åŒ–æ ‡ç­¾
- **CSS3**: Flexbox å¸ƒå±€ã€Grid å¸ƒå±€ã€åŠ¨ç”»ã€æ¸å˜
- **JavaScript (ES6+)**:
  - async/await
  - æ¨¡å—åŒ–ï¼ˆç±»ï¼‰
  - Promise
  - DOM æ“ä½œ
  - localStorage

### è®¾è®¡ç³»ç»Ÿ
- **CSS å˜é‡**: ç»Ÿä¸€çš„é…è‰²æ–¹æ¡ˆ
- **å“åº”å¼è®¾è®¡**: é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- **åŸå­åŒ– CSS**: å¯å¤ç”¨çš„æ ·å¼ç±»
- **åŠ¨ç”»æ•ˆæœ**:
  - æ—‹è½¬åŠ è½½å™¨
  - è„‰å†²åŠ¨ç”»
  - æ‚¬åœæ•ˆæœ
  - è¿‡æ¸¡åŠ¨ç”»

### ç»„ä»¶æ¶æ„
- **æ¨¡å—åŒ–è®¾è®¡**: æ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹å°è£…
- **å…¨å±€çŠ¶æ€ç®¡ç†**: app å¯¹è±¡
- **äº‹ä»¶é©±åŠ¨**: onclickã€onchangeã€onkeypress
- **å¼‚æ­¥å¤„ç†**: æ‰€æœ‰ I/O æ“ä½œéƒ½æ˜¯å¼‚æ­¥

---

## ğŸ¯ ç”¨æˆ·äº¤äº’æµç¨‹

### å®Œæ•´ä½¿ç”¨æµç¨‹

```
1. æ‰“å¼€ app.html
   â†“
2. ä¸Šä¼  HTML æ–‡ä»¶ï¼ˆæ‹–æ‹½æˆ–ç‚¹å‡»ï¼‰
   â†“
3. ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºç‰ˆæœ¬å¹¶æ„å»ºç´¢å¼•
   â†“
4. è¾“å…¥è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼ˆä¾‹å¦‚ï¼š"æ‰¾åˆ°æ‰€æœ‰å¯¼èˆª"ï¼‰
   â†“
5. æŸ¥çœ‹æŸ¥è¯¢ç»“æœï¼ˆåŒ¹é…å…ƒç´ åˆ—è¡¨ï¼‰
   â†“
6. ç‚¹å‡»"åˆ›å»ºä¿®æ”¹"æŒ‰é’®
   â†“
7. é€‰æ‹©ä¿®æ”¹ç±»å‹ï¼ˆæ ·å¼/å±æ€§/å†…å®¹/åˆ é™¤ï¼‰
   â†“
8. è¾“å…¥ä¿®æ”¹å‚æ•°ï¼ˆJSON æ ¼å¼æˆ–æ–‡æœ¬ï¼‰
   â†“
9. æŸ¥çœ‹é¢„è§ˆï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰
   â†“
10. ç¡®è®¤å¹¶åº”ç”¨ä¿®æ”¹
   â†“
11. ä¿®æ”¹æˆåŠŸï¼å¯ä»¥ç»§ç»­ä¸‹ä¸€ä¸ªæŸ¥è¯¢
```

### è®¾ç½®é…ç½®æµç¨‹

```
1. ç‚¹å‡»"è®¾ç½®"æŒ‰é’®
   â†“
2. è¾“å…¥ OpenRouter API Keyï¼ˆå¯é€‰ï¼‰
   â†“
3. é€‰æ‹© LLM æ¨¡å‹
   â†“
4. è®¾ç½®è‡ªåŠ¨é¢„è§ˆé€‰é¡¹
   â†“
5. ä¿å­˜è®¾ç½®
   â†“
6. è®¾ç½®å·²æŒä¹…åŒ–åˆ° localStorage
```

---

## ğŸ¨ UI è®¾è®¡äº®ç‚¹

### 1. é…è‰²æ–¹æ¡ˆ
```css
--primary-color: #4a90e2;      /* ä¸»è“è‰² */
--primary-dark: #357abd;       /* æ·±è“è‰² */
--success-color: #28a745;      /* æˆåŠŸç»¿è‰² */
--danger-color: #dc3545;       /* å±é™©çº¢è‰² */
--warning-color: #ffc107;      /* è­¦å‘Šé»„è‰² */
--bg-color: #f5f7fa;           /* èƒŒæ™¯ç°è‰² */
--sidebar-bg: #2c3e50;         /* ä¾§è¾¹æ æ·±è‰² */
```

### 2. è§†è§‰å±‚æ¬¡
- **Z-index å±‚çº§ç®¡ç†**:
  - Header: 100
  - Sidebar: 99
  - Modal: 1000
  - Loading: 10

### 3. äº¤äº’åé¦ˆ
- **æ‚¬åœæ•ˆæœ**: æ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ 
- **èšç„¦æ•ˆæœ**: è¾“å…¥æ¡†è“è‰²é«˜äº®
- **åŠ è½½çŠ¶æ€**: æ—‹è½¬åŠ¨ç”» + æ–‡å­—æç¤º
- **æˆåŠŸ/å¤±è´¥**: çŠ¶æ€æ é¢œè‰²å˜åŒ–

### 4. å“åº”å¼è®¾è®¡
```css
/* æ¡Œé¢: > 1024px */
ä¾§è¾¹æ : 280px å›ºå®šå®½åº¦

/* å¹³æ¿: 768px - 1024px */
ä¾§è¾¹æ : 240px å›ºå®šå®½åº¦

/* æ‰‹æœº: < 768px */
ä¾§è¾¹æ : éšè—ï¼Œå¯é€šè¿‡æŒ‰é’®å±•å¼€
```

---

## ğŸ“± å“åº”å¼é€‚é…

### æ¡Œé¢ç«¯ï¼ˆ> 1024pxï¼‰
- ä¾§è¾¹æ å›ºå®šæ˜¾ç¤º
- å®½å±å¸ƒå±€
- å®Œæ•´åŠŸèƒ½

### å¹³æ¿ç«¯ï¼ˆ768px - 1024pxï¼‰
- ä¾§è¾¹æ çª„åŒ–
- è°ƒæ•´å­—ä½“å¤§å°
- ä¼˜åŒ–é—´è·

### ç§»åŠ¨ç«¯ï¼ˆ< 768pxï¼‰
- ä¾§è¾¹æ éšè—
- æ±‰å ¡èœå•
- å‚ç›´å¸ƒå±€
- è§¦æ‘¸ä¼˜åŒ–

---

## ğŸ”Œ æ¨¡å—é›†æˆ

### å·²é›†æˆçš„æ ¸å¿ƒæ¨¡å—
```html
<!-- Phase 1 -->
<script src="core-modules.js"></script>

<!-- Phase 2 -->
<script src="indexer-modules.js"></script>
<script src="nlp-query-engine.js"></script>
<script src="tree-sitter-query-executor.js"></script>
<script src="llm-client.js"></script>

<!-- Phase 3 -->
<script src="code-modification-engine.js"></script>
<script src="transaction-manager.js"></script>
<script src="diff-generator.js"></script>
```

### æ¨¡å—é€šä¿¡æµç¨‹
```
ç”¨æˆ·è¾“å…¥
   â†“
NLP Engine â†’ Tree-sitter Query â†’ LLM Client
   â†“
æŸ¥è¯¢ç»“æœ
   â†“
Modification Engine â†’ Transaction Manager
   â†“
Diff Generator â†’ Preview Generator
   â†“
ç”¨æˆ·ç¡®è®¤ â†’ åº”ç”¨ä¿®æ”¹
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ‡’åŠ è½½
- æ¨¡æ€æ¡†å†…å®¹æŒ‰éœ€ç”Ÿæˆ
- ç‰ˆæœ¬åˆ—è¡¨æŒ‰éœ€åŠ è½½

### 2. ç¼“å­˜ç­–ç•¥
- API Key ç¼“å­˜åˆ° localStorage
- è®¾ç½®é€‰é¡¹æŒä¹…åŒ–

### 3. DOM æ“ä½œä¼˜åŒ–
- æ‰¹é‡æ›´æ–° innerHTML
- ä½¿ç”¨ DocumentFragmentï¼ˆé¢„è§ˆç”Ÿæˆï¼‰

### 4. å¼‚æ­¥å¤„ç†
- æ‰€æœ‰ I/O æ“ä½œå¼‚æ­¥
- é¿å…é˜»å¡ UI çº¿ç¨‹

---

## ğŸ› é”™è¯¯å¤„ç†

### 1. è¾“å…¥éªŒè¯
```javascript
if (!query) {
  alert('è¯·è¾“å…¥æŸ¥è¯¢å†…å®¹');
  return;
}

if (!app.currentVersionId) {
  alert('è¯·å…ˆä¸Šä¼ æ–‡ä»¶');
  return;
}
```

### 2. å¼‚å¸¸æ•è·
```javascript
try {
  await handleQuery();
} catch (error) {
  console.error('[App] æŸ¥è¯¢å¤±è´¥:', error);
  updateStatus('æŸ¥è¯¢å¤±è´¥', 'error');
  alert('æŸ¥è¯¢å¤±è´¥: ' + error.message);
}
```

### 3. å›æ»šæœºåˆ¶
```javascript
try {
  await applyModifications();
} catch (error) {
  await app.transactionManager.rollback();
  alert('ä¿®æ”¹å¤±è´¥ï¼Œå·²å›æ»š');
}
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: ä¿®æ”¹å¯¼èˆªæ æ ·å¼
```
1. ä¸Šä¼ åŒ…å«å¯¼èˆªçš„ HTML æ–‡ä»¶
2. è¾“å…¥: "æ‰¾åˆ°æ‰€æœ‰å¯¼èˆª"
3. ç‚¹å‡»ç¬¬ä¸€ä¸ªåŒ¹é…ç»“æœçš„"åˆ›å»ºä¿®æ”¹"
4. é€‰æ‹©: 1ï¼ˆä¿®æ”¹æ ·å¼ï¼‰
5. è¾“å…¥: {"background": "#001f3f", "color": "#fff"}
6. æŸ¥çœ‹é¢„è§ˆ
7. åº”ç”¨ä¿®æ”¹
```

### ç¤ºä¾‹ 2: åˆ é™¤é¡µè„š
```
1. è¾“å…¥: "æ‰¾åˆ°é¡µè„š"
2. ç‚¹å‡»åŒ¹é…ç»“æœçš„"åˆ›å»ºä¿®æ”¹"
3. é€‰æ‹©: 4ï¼ˆåˆ é™¤å…ƒç´ ï¼‰
4. ç¡®è®¤åˆ é™¤
5. åº”ç”¨ä¿®æ”¹
```

### ç¤ºä¾‹ 3: æ‰¹é‡ä¿®æ”¹æŒ‰é’®
```
1. è¾“å…¥: "æ‰¾åˆ°æ‰€æœ‰æŒ‰é’®"
2. å¯¹æ¯ä¸ªæŒ‰é’®åˆ›å»ºæ ·å¼ä¿®æ”¹
3. è®¾ç½®åœ†è§’: {"border-radius": "8px"}
4. æŸ¥çœ‹é¢„è§ˆï¼ˆæ˜¾ç¤ºæ‰€æœ‰ä¿®æ”¹ï¼‰
5. ä¸€æ¬¡æ€§åº”ç”¨æ‰€æœ‰ä¿®æ”¹
```

---

## âœ¨ æœªæ¥å¢å¼ºè®¡åˆ’

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰
- [ ] **æ’¤é”€/é‡åšåŠŸèƒ½**: Ctrl+Z æ”¯æŒ
- [ ] **æ‹–æ‹½æ’åº**: ä¿®æ”¹æ“ä½œé˜Ÿåˆ—æ’åº
- [ ] **å¿«æ·é”®æ”¯æŒ**: é”®ç›˜å¿«æ·æ“ä½œ

### ä¸­æœŸï¼ˆ3-4 å‘¨ï¼‰
- [ ] **ä¸»é¢˜åˆ‡æ¢**: æ·±è‰²æ¨¡å¼/æµ…è‰²æ¨¡å¼
- [ ] **å¤šè¯­è¨€æ”¯æŒ**: è‹±æ–‡ç•Œé¢
- [ ] **å¯¼å‡ºåŠŸèƒ½**: å¯¼å‡ºä¿®æ”¹åçš„æ–‡ä»¶

### é•¿æœŸï¼ˆ1-2 æœˆï¼‰
- [ ] **åä½œåŠŸèƒ½**: å¤šäººåŒæ—¶ç¼–è¾‘
- [ ] **äº‘ç«¯åŒæ­¥**: ç‰ˆæœ¬äº‘ç«¯å¤‡ä»½
- [ ] **æ’ä»¶ç³»ç»Ÿ**: ç¬¬ä¸‰æ–¹æ‰©å±•

---

## ğŸ“ Phase 4 æ€»ç»“

**Phase 4 æˆåŠŸå®ç°äº†å®Œæ•´çš„ç”¨æˆ·ç•Œé¢:**

âœ… ç°ä»£åŒ–çš„ Web åº”ç”¨è®¾è®¡
âœ… å®Œæ•´çš„ç”¨æˆ·äº¤äº’æµç¨‹
âœ… å“åº”å¼å¸ƒå±€é€‚é…
âœ… ç¾è§‚çš„è§†è§‰æ•ˆæœ
âœ… å‹å¥½çš„é”™è¯¯æç¤º
âœ… é«˜æ•ˆçš„æ€§èƒ½è¡¨ç°
âœ… å®Œæ•´çš„æ¨¡å—é›†æˆ

**ç”¨æˆ·ç°åœ¨å¯ä»¥:**
- âœ… é€šè¿‡ Web ç•Œé¢ä¸Šä¼ æ–‡ä»¶
- âœ… ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢ä»£ç 
- âœ… å¯è§†åŒ–æŸ¥çœ‹æŸ¥è¯¢ç»“æœ
- âœ… åˆ›å»ºå’Œé¢„è§ˆä¿®æ”¹
- âœ… å®‰å…¨åœ°åº”ç”¨ä¿®æ”¹
- âœ… ç®¡ç†å¤šä¸ªç‰ˆæœ¬
- âœ… æŸ¥çœ‹å†å²è®°å½•

**ä¸‹ä¸€æ­¥ (Phase 5):**
- â³ æ€§èƒ½ä¼˜åŒ–
- â³ å®Œæ•´æµ‹è¯•
- â³ æ–‡æ¡£å®Œå–„
- â³ å‘å¸ƒå‡†å¤‡

---

**å¼€å‘è€…**: Claude Code
**é¡¹ç›®**: Prompty V2 - AI é©±åŠ¨çš„ç½‘ç«™ç¼–è¾‘å·¥å…·
**è¿›åº¦**: Phase 4 å®Œæˆ âœ… â†’ Phase 5 å‡†å¤‡ä¸­ â³
**æ€»ä½“å®Œæˆåº¦**: 80%

**æœ€åæ›´æ–°**: 2025-11-01
**ä¸‹æ¬¡æ›´æ–°**: Phase 5 å®Œæˆå
